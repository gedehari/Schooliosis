// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum JenisKelamin {
  Laki
  Perempuan
}

enum Agama {
  Islam
  Kristen
  Katolik
  Hindu
  Budha
  Konghucu
}

enum IdentityType {
  Siswa
  Guru
}

enum JenisJadwal {
  Upacara
  Pembelajaran
  Istirahat
}

model Siswa {
  nis           Int          @id
  nama          String       @db.VarChar(255)
  tempatLahir   String       @db.VarChar(32)
  tanggalLahir  DateTime     @db.Date
  jenisKelamin  JenisKelamin
  agama         Agama
  alamat        String
  namaAyah      String       @db.VarChar(255)
  pekerjaanAyah String?      @db.VarChar(32)
  namaIbu       String       @db.VarChar(255)
  pekerjaanIbu  String?      @db.VarChar(32)
  kelas         Kelas?       @relation(fields: [kelasId], references: [id])
  kelasId       Int?
  user          User?
}

model Guru {
  nik          Int          @id
  nama         String       @db.VarChar(255)
  tempatLahir  String       @db.VarChar(32)
  tanggalLahir DateTime     @db.Date
  jenisKelamin JenisKelamin
  agama        Agama
  alamat       String
  kelas        Kelas?       @relation(fields: [kelasId], references: [id])
  kelasId      Int?         @unique
  user         User?
}

model User {
  id           Int          @id @default(autoincrement())
  identityType IdentityType
  siswa        Siswa?       @relation(fields: [siswaNis], references: [nis])
  siswaNis     Int?         @unique
  guru         Guru?        @relation(fields: [guruNik], references: [nik])
  guruNik      Int?         @unique
  email        String
  passwordHash String       @db.VarChar(255)
}

model Kelas {
  id      Int      @id @default(autoincrement())
  tingkat Int      @db.SmallInt
  huruf   String   @db.Char(1)
  siswa   Siswa[]
  jadwal  Jadwal[]
  guru    Guru?
}

model MataPelajaran {
  id            Int      @id @default(autoincrement())
  mataPelajaran String   @db.VarChar(64)
  singkatan     String   @db.VarChar(16)
  kkm           Float
  Jadwal        Jadwal[]
}

model JamPelajaran {
  id      Int      @id @default(autoincrement())
  mulai   Int
  selesai Int
  Jadwal  Jadwal[]
}

model Jadwal {
  id              Int            @id @default(autoincrement())
  hari            Int
  jenisJadwal     JenisJadwal
  mataPelajaran   MataPelajaran? @relation(fields: [mataPelajaranId], references: [id])
  mataPelajaranId Int?
  jamPelajaran    JamPelajaran   @relation(fields: [jamPelajaranId], references: [id])
  jamPelajaranId  Int
  kelas           Kelas          @relation(fields: [kelasId], references: [id])
  kelasId         Int
}
